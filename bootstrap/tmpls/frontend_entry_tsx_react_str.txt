import { done, isStarted, start } from "nprogress";
import { createRoot } from "react-dom/client";
import {
	getRootEl,
	initClient,
	revalidateOnWindowFocus,
	setupGlobalLoadingIndicator,
} from "river.now/client";
import { RiverProvider } from "river.now/react";
import { App } from "./app.tsx";
import { riverAppConfig } from "./river.gen.ts";

await initClient({
	riverAppConfig,
	renderFn: () => {
		createRoot(getRootEl()).render(
			<RiverProvider>
				<App />
			</RiverProvider>,
		);
	},
});

setupGlobalLoadingIndicator({ start, stop: done, isRunning: isStarted });
revalidateOnWindowFocus({ staleTimeMS: 10_000 });
